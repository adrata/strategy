generator client {
  provider   = "prisma-client-js"
  engineType = "binary"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Chat {
  id          String   @id @default(ulid())
  workspaceId String
  type        String
  name        String?
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime

  @@index([type])
  @@index([workspaceId])
  @@index([workspaceId, type])
}

model entities {
  id           String    @id @default(ulid())
  type         String    @db.VarChar(50)
  workspace_id String
  created_at   DateTime  @default(now())
  updated_at   DateTime? @default(now())
  metadata     Json?

  @@index([workspace_id])
  @@index([type])
  @@index([workspace_id, type])
  @@index([created_at])
  @@map("entities")
}

model ChatMember {
  id       String   @id @default(ulid())
  chatId   String
  userId   String
  role     String   @default("member")
  joinedAt DateTime @default(now())

  @@unique([chatId, userId])
  @@index([chatId])
  @@index([userId])
}

model Message {
  id        String   @id @default(ulid())
  chatId    String
  senderId  String
  content   String
  type      String   @default("text")
  metadata  Json?
  createdAt DateTime @default(now())
  updatedAt DateTime

  @@index([chatId])
  @@index([createdAt])
  @@index([senderId])
}

model BuyerGroupToPerson {
  buyerGroupId String
  createdAt    DateTime?    @default(now()) @db.Timestamp(6)
  influence    String?      @db.VarChar(20)
  isPrimary    Boolean?     @default(false)
  notes        String?
  personId     String
  role         String?      @db.VarChar(50)
  updatedAt    DateTime?    @default(now()) @db.Timestamp(6)
  buyerGroup   buyer_groups @relation(fields: [buyerGroupId], references: [id], onDelete: Cascade)
  person       people       @relation(fields: [personId], references: [id], onDelete: Cascade)

  @@id([buyerGroupId, personId], map: "_BuyerGroupToPerson_AB_pkey")
  @@map("_BuyerGroupToPerson")
}

model EmailToCompany {
  A String
  B String

  @@id([A, B], map: "_EmailToCompany_AB_pkey")
  @@map("_EmailToCompany")
}

model EmailToLead {
  A String
  B String

  @@id([A, B], map: "_EmailToLead_AB_pkey")
  @@map("_EmailToLead")
}

model EmailToOpportunity {
  A String
  B String

  @@id([A, B], map: "_EmailToOpportunity_AB_pkey")
  @@map("_EmailToOpportunity")
}

model EmailToPerson {
  A String
  B String

  @@id([A, B], map: "_EmailToPerson_AB_pkey")
  @@map("_EmailToPerson")
}

model EmailToAction {
  A String
  B String

  @@id([A, B], map: "_EmailToAction_AB_pkey")
  @@map("_EmailToAction")
}

model EmailToPipelineExecution {
  A String
  B String

  @@id([A, B], map: "_EmailToPipelineExecution_AB_pkey")
  @@map("_EmailToPipelineExecution")
}

model EmailToProspect {
  A String
  B String

  @@id([A, B], map: "_EmailToProspect_AB_pkey")
  @@map("_EmailToProspect")
}

model EventToCompany {
  A String
  B String

  @@id([A, B], map: "_EventToCompany_AB_pkey")
  @@map("_EventToCompany")
}

model EventToLead {
  A String
  B String

  @@id([A, B], map: "_EventToLead_AB_pkey")
  @@map("_EventToLead")
}

model EventToOpportunity {
  A String
  B String

  @@id([A, B], map: "_EventToOpportunity_AB_pkey")
  @@map("_EventToOpportunity")
}

model EventToPerson {
  A String
  B String

  @@id([A, B], map: "_EventToPerson_AB_pkey")
  @@map("_EventToPerson")
}

model EventToProspect {
  A String
  B String

  @@id([A, B], map: "_EventToProspect_AB_pkey")
  @@map("_EventToProspect")
}

model ProspectOpportunities {
  A String
  B String

  @@id([A, B], map: "_ProspectOpportunities_AB_pkey")
  @@map("_ProspectOpportunities")
}

model actions {
  id             String     @id(map: "activities_pkey") @default(ulid())
  workspaceId    String     @db.VarChar(30)
  userId         String     @db.VarChar(30)
  leadId         String?    @db.VarChar(30)
  opportunityId  String?    @db.VarChar(30)
  type           String     @db.VarChar(30)
  subject        String
  description    String?
  outcome        String?
  scheduledAt    DateTime?
  scheduledDate  DateTime?
  completedAt    DateTime?
  duration       Int?
  status         String     @default("planned") @db.VarChar(20)
  priority       String     @default("normal") @db.VarChar(10)
  attachments    Json?
  metadata       Json?
  createdAt      DateTime   @default(now())
  updatedAt      DateTime
  externalId     String?
  prospectId     String?    @db.VarChar(30)
  assignedUserId String?    @db.VarChar(30)
  campaignType   String?    @db.VarChar(50)
  companyId      String?    @db.VarChar(30)
  personId       String?    @db.VarChar(30)
  company        companies? @relation(fields: [companyId], references: [id])
  person         people?    @relation(fields: [personId], references: [id])
}

model agency_users {
  id                String   @id @default(ulid())
  userId            String   @db.VarChar(30)
  agencyWorkspaceId String
  role              String   @default("recruiter") @db.VarChar(50)
  permissions       Json?
  isActive          Boolean  @default(true)
  createdAt         DateTime @default(now())
  updatedAt         DateTime
}

model agency_workspaces {
  id            String   @id @default(ulid())
  name          String   @db.VarChar(255)
  slug          String   @db.VarChar(100)
  agencyOwnerId String   @db.VarChar(30)
  settings      Json?
  isActive      Boolean  @default(true)
  branding      Json?
  permissions   Json?
  createdAt     DateTime @default(now())
  updatedAt     DateTime
}

model api_cost_tracking {
  id            String   @id @default(ulid())
  session_id    String?
  api_name      String
  requests_made Int      @default(0)
  cost_incurred Decimal  @default(0) @db.Decimal(10, 4)
  success_count Int      @default(0)
  failure_count Int      @default(0)
  user_id       String
  workspace_id  String
  date          DateTime @default(now()) @db.Date
  created_at    DateTime @default(now())
}

model api_key_audit_logs {
  id          String   @id @default(ulid())
  apiKeyId    String   @db.VarChar(30)
  workspaceId String   @db.VarChar(30)
  userId      String   @db.VarChar(30)
  action      String   @db.VarChar(50)
  details     Json?
  ipAddress   String?  @db.Inet
  userAgent   String?
  timestamp   DateTime @default(now())
  api_keys    api_keys @relation(fields: [apiKeyId], references: [id])

  @@index([action])
  @@index([apiKeyId])
  @@index([timestamp])
  @@index([userId])
  @@index([workspaceId])
}

model api_key_usage_logs {
  id           String   @id @default(ulid())
  apiKeyId     String   @db.VarChar(30)
  workspaceId  String   @db.VarChar(30)
  userId       String?  @db.VarChar(30)
  endpoint     String   @db.VarChar(200)
  method       String   @db.VarChar(10)
  statusCode   Int
  responseTime Int
  requestSize  Int?
  responseSize Int?
  ipAddress    String?  @db.Inet
  userAgent    String?
  referer      String?
  errorMessage String?
  metadata     Json?
  timestamp    DateTime @default(now())
  api_keys     api_keys @relation(fields: [apiKeyId], references: [id])

  @@index([apiKeyId])
  @@index([endpoint])
  @@index([statusCode])
  @@index([timestamp])
  @@index([workspaceId])
}

model api_keys {
  id                 String               @id @default(ulid())
  workspaceId        String               @db.VarChar(30)
  userId             String               @db.VarChar(30)
  name               String               @db.VarChar(255)
  description        String?
  keyHash            String               @unique @db.VarChar(255)
  keyPrefix          String               @db.VarChar(20)
  permissions        Json                 @default("[]")
  scopes             String[]             @default([])
  rateLimit          Int                  @default(1000)
  rateLimitPeriod    String               @default("hour") @db.VarChar(20)
  quotaLimit         Int?
  quotaUsed          Int                  @default(0)
  quotaPeriod        String               @default("month") @db.VarChar(20)
  lastUsedAt         DateTime?
  expiresAt          DateTime?
  isActive           Boolean              @default(true)
  isRotated          Boolean              @default(false)
  parentKeyId        String?              @db.VarChar(30)
  rotationSchedule   String?              @db.VarChar(50)
  ipWhitelist        String[]             @default([])
  userAgentWhitelist String[]             @default([])
  webhookUrl         String?              @db.VarChar(500)
  metadata           Json?
  createdAt          DateTime             @default(now())
  updatedAt          DateTime
  createdBy          String               @db.VarChar(30)
  updatedBy          String?              @db.VarChar(30)
  api_key_audit_logs api_key_audit_logs[]
  api_key_usage_logs api_key_usage_logs[]
  api_keys           api_keys?            @relation("api_keysToapi_keys", fields: [parentKeyId], references: [id])
  other_api_keys     api_keys[]           @relation("api_keysToapi_keys")

  @@index([expiresAt])
  @@index([isActive])
  @@index([keyHash])
  @@index([keyPrefix])
  @@index([lastUsedAt])
  @@index([userId])
  @@index([workspaceId])
}

model api_usage_metrics {
  id              String   @id @default(ulid())
  workspaceId     String   @db.VarChar(30)
  userId          String?  @db.VarChar(30)
  apiKey          String?  @db.VarChar(100)
  endpoint        String   @db.VarChar(200)
  method          String   @db.VarChar(10)
  requestCount    Int      @default(1)
  responseTime    Float?
  errorCount      Int      @default(0)
  quotaUsed       Int      @default(0)
  dataTransferred Int      @default(0)
  periodStart     DateTime
  periodEnd       DateTime
}

model business_impact_predictions {
  id                 String   @id @default(ulid())
  workspaceId        String
  leadId             String?
  companyId          String?
  actionType         String
  actionData         Json
  predictedOutcome   String
  predictedValue     Float?
  confidence         Float
  businessStage      String
  kpiCategory        String
  reasoning          Json
  actualOutcome      String?
  actualValue        Float?
  predictionAccuracy Float?
  createdAt          DateTime @default(now())
  updatedAt          DateTime
  prospectId         String?
}

model business_kpis {
  id                String   @id @default(ulid())
  workspaceId       String
  kpiName           String
  kpiCategory       String
  currentValue      Float
  targetValue       Float?
  previousValue     Float?
  changePercent     Float?
  measurementPeriod String
  lastCalculated    DateTime @default(now())
  createdAt         DateTime @default(now())
  updatedAt         DateTime
}

model cache_metrics {
  id              String   @id @default(ulid())
  workspaceId     String   @db.VarChar(30)
  cacheKey        String   @db.VarChar(200)
  cacheType       String   @db.VarChar(50)
  hitCount        Int      @default(0)
  missCount       Int      @default(0)
  avgResponseTime Float?
  lastAccessed    DateTime @default(now())
  dataSize        Int?
  ttl             Int?
}

model calendar {
  id          String    @id @default(ulid())
  workspaceId String    @db.VarChar(30)
  userId      String    @db.VarChar(30)
  name        String
  description String?
  color       String?   @default("#4285f4") @db.VarChar(7)
  isPrimary   Boolean   @default(false)
  isActive    Boolean   @default(true)
  platform    String    @default("microsoft") @db.VarChar(20)
  externalId  String?
  syncToken   String?
  lastSyncAt  DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime

  @@index([externalId])
  @@index([platform])
  @@index([userId])
  @@index([workspaceId])
}

model candidate_touchpoints {
  id          String   @id @default(ulid())
  candidateId String
  type        String   @db.VarChar(50)
  date        DateTime @default(now())
  notes       String?
  outcome     String?  @db.VarChar(50)
  nextAction  String?  @db.VarChar(255)
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model candidates {
  id                 String   @id @default(ulid())
  firstName          String   @db.VarChar(100)
  lastName           String   @db.VarChar(100)
  email              String   @db.VarChar(255)
  phone              String?  @db.VarChar(50)
  location           Json?
  currentTitle       String   @db.VarChar(255)
  currentCompany     String   @db.VarChar(255)
  experience         Int      @default(0)
  expectedSalary     Decimal? @db.Decimal(10, 2)
  currentSalary      Decimal? @db.Decimal(10, 2)
  currency           String   @default("USD") @db.VarChar(3)
  skills             String[] @default([])
  certifications     String[] @default([])
  education          Json[]   @default([])
  status             String   @default("sourced") @db.VarChar(50)
  stage              String?  @db.VarChar(100)
  appliedJobs        String[] @default([])
  clientCompanyId    String?  @db.VarChar(30)
  recruiterAssigned  String   @db.VarChar(30)
  workspaceId        String   @db.VarChar(30)
  monacoIntelligence Json?
  notes              String?
  createdAt          DateTime @default(now())
  updatedAt          DateTime
}

model companies {
  id                      String              @id @default(ulid()) @db.VarChar(30)
  workspaceId             String              @db.VarChar(30)
  assignedUserId          String?             @db.VarChar(30)
  name                    String              @db.VarChar(255)
  legalName               String?             @db.VarChar(255)
  tradingName             String?             @db.VarChar(255)
  localName               String?             @db.VarChar(255)
  website                 String?             @db.VarChar(500)
  email                   String?             @db.VarChar(300)
  phone                   String?             @db.VarChar(50)
  fax                     String?             @db.VarChar(50)
  address                 String?
  city                    String?             @db.VarChar(100)
  state                   String?             @db.VarChar(100)
  country                 String?             @db.VarChar(100)
  postalCode              String?             @db.VarChar(20)
  industry                String?             @db.VarChar(100)
  sector                  String?             @db.VarChar(100)
  size                    String?             @db.VarChar(100)
  revenue                 Decimal?            @db.Decimal(15, 2)
  currency                String?             @default("USD") @db.VarChar(3)
  registrationNumber      String?             @db.VarChar(100)
  taxId                   String?             @db.VarChar(100)
  vatNumber               String?             @db.VarChar(100)
  description             String?
  notes                   String?
  tags                    String[]            @default([])
  customFields            Json?
  preferredLanguage       String?             @db.VarChar(10)
  timezone                String?             @db.VarChar(50)
  createdAt               DateTime?           @default(now()) @db.Timestamp(6)
  updatedAt               DateTime?           @default(now()) @db.Timestamp(6)
  deletedAt               DateTime?           @db.Timestamp(6)
  accountType             String?             @db.VarChar(50)
  primaryContact          String?             @db.VarChar(100)
  tier                    String?             @db.VarChar(20)
  externalId              String?             @db.VarChar(100)
  vertical                String?             @db.VarChar(50)
  zohoId                  String?             @db.VarChar(50)
  approvalProcess         String?             @default("Committee") @db.VarChar(30)
  budgetCycle             String?             @default("Annual") @db.VarChar(20)
  businessChallenges      String[]            @default([])
  businessPriorities      String[]            @default([])
  competitiveAdvantages   String[]            @default([])
  decisionTimeline        String?             @default("3-6 months") @db.VarChar(20)
  growthOpportunities     String[]            @default([])
  growthPotential         String?             @default("High") @db.VarChar(20)
  keyInfluencers          String?             @default("C-Level") @db.VarChar(30)
  marketPosition          String?             @default("Established") @db.VarChar(30)
  marketThreats           String[]            @default([])
  relationshipStrength    String?             @default("Good") @db.VarChar(20)
  riskLevel               String?             @default("Low") @db.VarChar(20)
  strategicInitiatives    String[]            @default([])
  successMetrics          String[]            @default([])
  createdBy               String?             @db.VarChar(30)
  updatedBy               String?             @db.VarChar(30)
  version                 Int?                @default(1)
  entity_id               String?             @db.VarChar(30)
  lastAction              String?
  lastActionDate          DateTime?           @db.Timestamp(6)
  nextAction              String?
  nextActionDate          DateTime?           @db.Timestamp(6)
  actionStatus            String?
  industryId              String?             @db.VarChar(30)
  verticalId              String?             @db.VarChar(30)
  businessApproach        String?             @db.VarChar(200)
  clientEngagementModel   String?             @db.VarChar(100)
  communicationStyle      String?             @default("Professional") @db.VarChar(50)
  deliveryCapabilities    String[]            @default([])
  expertiseAreas          String[]            @default([])
  industrySpecializations String[]            @default([])
  marketPositioning       String?             @db.VarChar(100)
  projectMethodology      String?             @db.VarChar(100)
  qualityStandards        String[]            @default([])
  serviceOfferings        String[]            @default([])
  targetMarkets           String[]            @default([])
  targetSegments          String[]            @default([])
  technicalCapabilities   String[]            @default([])
  uniqueValuePropositions String[]            @default([])
  rank                    Int?                @default(0)
  situationAnalysis       String?
  complications           String?
  competitors             String[]
  activeJobPostings       Int?
  employeeCount           Int?
  facebookUrl             String?             @db.VarChar(500)
  foundedYear             Int?
  githubUrl               String?             @db.VarChar(500)
  instagramUrl            String?             @db.VarChar(500)
  lastFundingAmount       BigInt?
  lastFundingDate         DateTime?           @db.Date
  linkedinFollowers       Int?
  linkedinUrl             String?             @db.VarChar(500)
  naicsCodes              String[]
  revenueCurrency         String?             @db.VarChar(3)
  sicCodes                String[]
  strategicIntelligence   String?
  technologiesUsed        String[]
  twitterUrl              String?             @db.VarChar(500)
  youtubeUrl              String?             @db.VarChar(500)
  isPublic                Boolean?
  stockSymbol             String?             @db.VarChar(20)
  logoUrl                 String?             @db.VarChar(500)
  domain                  String?             @db.VarChar(255)
  hqLocation              String?             @db.VarChar(255)
  hqFullAddress           String?             @db.VarChar(500)
  hqCity                  String?             @db.VarChar(100)
  hqState                 String?             @db.VarChar(100)
  hqStreet                String?             @db.VarChar(255)
  hqZipcode               String?             @db.VarChar(20)
  twitterFollowers        Int?
  owlerFollowers          Int?
  companyUpdates          Json?
  numTechnologiesUsed     Int?
  descriptionEnriched     String?
  descriptionMetadataRaw  String?
  hqRegion                String[]
  hqCountryIso2           String?             @db.VarChar(2)
  hqCountryIso3           String?             @db.VarChar(3)
  actions                 actions[]
  buyerGroups             buyer_groups[]
  industryData            industries?         @relation(fields: [industryId], references: [id])
  verticalData            industry_verticals? @relation(fields: [verticalId], references: [id])
  people                  people[]

  @@index([entity_id], map: "idx_companies_entity_id")
}

model buyer_groups {
  id              String               @id @default(ulid()) @db.VarChar(30)
  workspaceId     String               @db.VarChar(30)
  companyId       String?              @db.VarChar(30)
  assignedUserId  String?              @db.VarChar(30)
  name            String               @db.VarChar(255)
  description     String?
  purpose         String?              @db.VarChar(500)
  status          String?              @default("active") @db.VarChar(20)
  priority        String?              @default("medium") @db.VarChar(20)
  estimatedValue  Decimal?             @db.Decimal(15, 2)
  currency        String?              @default("USD") @db.VarChar(3)
  decisionDate    DateTime?            @db.Timestamp(6)
  budget          Decimal?             @db.Decimal(15, 2)
  timeline        String?              @db.VarChar(100)
  decisionProcess String?              @db.VarChar(100)
  notes           String?
  tags            String[]             @default([])
  customFields    Json?
  createdAt       DateTime?            @default(now()) @db.Timestamp(6)
  updatedAt       DateTime?            @default(now()) @db.Timestamp(6)
  deletedAt       DateTime?            @db.Timestamp(6)
  createdBy       String?              @db.VarChar(30)
  updatedBy       String?              @db.VarChar(30)
  version         Int?                 @default(1)
  entity_id       String?              @db.VarChar(30)
  people          BuyerGroupToPerson[]
  company         companies?           @relation(fields: [companyId], references: [id])

  @@index([entity_id], map: "idx_buyer_groups_entity_id")
  @@index([workspaceId], map: "idx_buyer_groups_workspace")
  @@index([companyId], map: "idx_buyer_groups_company")
}

model people {
  id                String               @id @default(ulid()) @db.VarChar(30)
  workspaceId       String               @db.VarChar(30)
  companyId         String?              @db.VarChar(30)
  assignedUserId    String?              @db.VarChar(30)
  firstName         String               @db.VarChar(100)
  lastName          String               @db.VarChar(100)
  middleName        String?              @db.VarChar(100)
  fullName          String               @db.VarChar(200)
  displayName       String?              @db.VarChar(200)
  salutation        String?              @db.VarChar(50)
  suffix            String?              @db.VarChar(50)
  jobTitle          String?              @db.VarChar(300)
  department        String?              @db.VarChar(200)
  seniority         String?              @db.VarChar(50)
  email             String?              @db.VarChar(300)
  workEmail         String?              @db.VarChar(300)
  personalEmail     String?              @db.VarChar(300)
  secondaryEmail    String?              @db.VarChar(300)
  phone             String?              @db.VarChar(50)
  mobilePhone       String?              @db.VarChar(50)
  workPhone         String?              @db.VarChar(50)
  linkedinUrl       String?              @db.VarChar(500)
  twitterHandle     String?              @db.VarChar(100)
  address           String?              @db.VarChar(500)
  city              String?              @db.VarChar(100)
  state             String?              @db.VarChar(100)
  country           String?              @db.VarChar(100)
  postalCode        String?              @db.VarChar(50)
  dateOfBirth       DateTime?            @db.Timestamp(6)
  gender            String?              @db.VarChar(20)
  notes             String?
  bio               String?
  tags              String[]             @default([])
  customFields      Json?
  preferredLanguage String?              @db.VarChar(10)
  timezone          String?              @db.VarChar(50)
  status            String?              @default("active") @db.VarChar(20)
  lastEnriched      DateTime?            @db.Timestamp(6)
  enrichmentSources String[]             @default([])
  emailVerified     Boolean?             @default(false)
  phoneVerified     Boolean?             @default(false)
  mobileVerified    Boolean?             @default(false)
  enrichmentScore   Decimal?             @db.Decimal(5, 2)
  emailConfidence   Decimal?             @db.Decimal(5, 2)
  phoneConfidence   Decimal?             @db.Decimal(5, 2)
  dataCompleteness  Decimal?             @db.Decimal(5, 2)
  createdAt         DateTime?            @default(now()) @db.Timestamp(6)
  updatedAt         DateTime?            @default(now()) @db.Timestamp(6)
  deletedAt         DateTime?            @db.Timestamp(6)
  entity_id         String?              @db.VarChar(30)
  profilePictureUrl String?              @db.VarChar(500)
  role              String?              @db.VarChar(50)
  lastAction        String?
  lastActionDate    DateTime?            @db.Timestamp(6)
  nextAction        String?
  nextActionDate    DateTime?            @db.Timestamp(6)
  actionStatus      String?
  engagementScore   Float?               @default(0)
  funnelStage       String?              @default("Prospect") @db.VarChar(50)
  buyerGroupRole    String?              @db.VarChar(50)
  rank              Int?                 @default(0)
  buyerGroups       BuyerGroupToPerson[]
  actions           actions[]
  company           companies?           @relation(fields: [companyId], references: [id])

  @@index([entity_id], map: "idx_people_entity_id")
  @@index([rank], map: "idx_people_rank")
  @@index([workspaceId, rank], map: "idx_people_workspace_rank")
}

model custom_attributes {
  id              String        @id @default(ulid())
  customTableId   String        @db.VarChar(30)
  name            String        @db.VarChar(100)
  displayName     String        @db.VarChar(200)
  description     String?
  type            String        @db.VarChar(50)
  isRequired      Boolean       @default(false)
  isUnique        Boolean       @default(false)
  isSearchable    Boolean       @default(true)
  defaultValue    String?
  validationRules Json?
  options         Json?
  sortOrder       Int           @default(0)
  isVisible       Boolean       @default(true)
  width           Int?          @default(200)
  helpText        String?
  isComputed      Boolean       @default(false)
  formula         String?
  isEncrypted     Boolean       @default(false)
  createdAt       DateTime      @default(now())
  updatedAt       DateTime
  createdBy       String        @db.VarChar(30)
  updatedBy       String?       @db.VarChar(30)
  version         Int           @default(1)
  custom_tables   custom_tables @relation(fields: [customTableId], references: [id], onDelete: Cascade)

  @@unique([customTableId, name])
  @@index([customTableId, isVisible])
  @@index([customTableId, sortOrder])
  @@index([type])
}

model custom_record_attachments {
  id             String         @id @default(ulid())
  customRecordId String         @db.VarChar(30)
  workspaceId    String         @db.VarChar(30)
  fileName       String         @db.VarChar(255)
  fileSize       Int
  mimeType       String         @db.VarChar(100)
  filePath       String         @db.VarChar(500)
  thumbnailPath  String?        @db.VarChar(500)
  description    String?
  tags           String[]       @default([])
  isPublic       Boolean        @default(false)
  createdAt      DateTime       @default(now())
  createdBy      String         @db.VarChar(30)
  custom_records custom_records @relation(fields: [customRecordId], references: [id], onDelete: Cascade)

  @@index([customRecordId])
  @@index([mimeType])
  @@index([workspaceId, createdAt])
}

model custom_record_comments {
  id             String         @id @default(ulid())
  customRecordId String         @db.VarChar(30)
  workspaceId    String         @db.VarChar(30)
  content        String
  isInternal     Boolean        @default(false)
  isResolved     Boolean        @default(false)
  createdAt      DateTime       @default(now())
  updatedAt      DateTime
  createdBy      String         @db.VarChar(30)
  updatedBy      String?        @db.VarChar(30)
  custom_records custom_records @relation(fields: [customRecordId], references: [id], onDelete: Cascade)

  @@index([createdBy])
  @@index([customRecordId])
  @@index([workspaceId, createdAt])
}

model custom_records {
  id                        String                      @id @default(ulid())
  customTableId             String                      @db.VarChar(30)
  workspaceId               String                      @db.VarChar(30)
  data                      Json
  isActive                  Boolean                     @default(true)
  isArchived                Boolean                     @default(false)
  tags                      String[]                    @default([])
  searchVector              String?
  createdAt                 DateTime                    @default(now())
  updatedAt                 DateTime
  createdBy                 String                      @db.VarChar(30)
  updatedBy                 String?                     @db.VarChar(30)
  version                   Int                         @default(1)
  custom_record_attachments custom_record_attachments[]
  custom_record_comments    custom_record_comments[]
  custom_tables             custom_tables               @relation(fields: [customTableId], references: [id], onDelete: Cascade)

  @@index([customTableId, isActive])
  @@index([customTableId, workspaceId])
  @@index([workspaceId, createdAt])
  @@index([workspaceId, isActive])
  @@index([searchVector], map: "idx_custom_records_search")
}

model custom_relationships {
  id               String   @id @default(ulid())
  workspaceId      String   @db.VarChar(30)
  name             String   @db.VarChar(100)
  displayName      String   @db.VarChar(200)
  description      String?
  sourceTable      String   @db.VarChar(100)
  targetTable      String   @db.VarChar(100)
  relationshipType String   @db.VarChar(50)
  sourceField      String   @db.VarChar(100)
  targetField      String   @db.VarChar(100)
  isActive         Boolean  @default(true)
  cascadeDelete    Boolean  @default(false)
  isRequired       Boolean  @default(false)
  sortOrder        Int      @default(0)
  isVisible        Boolean  @default(true)
  createdAt        DateTime @default(now())
  updatedAt        DateTime
  createdBy        String   @db.VarChar(30)
  updatedBy        String?  @db.VarChar(30)
  version          Int      @default(1)

  @@index([workspaceId, relationshipType])
  @@index([workspaceId, sourceTable])
  @@index([workspaceId, targetTable])
}

model custom_tables {
  id                String              @id @default(ulid())
  workspaceId       String              @db.VarChar(30)
  name              String              @db.VarChar(100)
  displayName       String              @db.VarChar(200)
  description       String?
  icon              String?             @db.VarChar(50)
  color             String?             @db.VarChar(7)
  isActive          Boolean             @default(true)
  isSystem          Boolean             @default(false)
  sortOrder         Int                 @default(0)
  permissions       Json?
  isPublic          Boolean             @default(false)
  recordCount       Int                 @default(0)
  lastUsedAt        DateTime?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime
  createdBy         String              @db.VarChar(30)
  updatedBy         String?             @db.VarChar(30)
  version           Int                 @default(1)
  custom_attributes custom_attributes[]
  custom_records    custom_records[]

  @@unique([workspaceId, name])
  @@index([createdBy])
  @@index([workspaceId, isActive])
  @@index([workspaceId, sortOrder])
}

model data_access_logs {
  id             String   @id @default(ulid())
  workspaceId    String   @db.VarChar(30)
  userId         String?  @db.VarChar(30)
  entityType     String   @db.VarChar(50)
  entityId       String   @db.VarChar(30)
  accessType     String   @db.VarChar(20)
  fieldsAccessed String[] @default([])
  accessMethod   String   @db.VarChar(20)
  sourceIp       String?  @db.Inet
  userAgent      String?
  sessionId      String?
  businessReason String?
  duration       Int?
  timestamp      DateTime @default(now())
}

model data_quality_metrics {
  id             String   @id @default(ulid())
  workspaceId    String   @db.VarChar(30)
  entityType     String   @db.VarChar(50)
  entityId       String   @db.VarChar(30)
  fieldName      String   @db.VarChar(100)
  qualityType    String   @db.VarChar(20)
  qualityScore   Float
  issueCount     Int      @default(0)
  issues         Json?
  lastChecked    DateTime @default(now())
  autoRemediated Boolean  @default(false)
  remediation    Json?
}

model demo_scenarios {
  id             String   @id @default(ulid())
  name           String
  slug           String
  description    String
  industry       String
  targetAudience String
  isActive       Boolean  @default(true)
  sortOrder      Int      @default(0)
  createdAt      DateTime @default(now())
  updatedAt      DateTime
  config         Json?
  branding       Json?
  features       Json?
  demoUser       Json?
}

model email_accounts {
  id                      String    @id @default(ulid())
  workspaceId             String
  userId                  String
  platform                String
  email                   String
  displayName             String
  isActive                Boolean   @default(true)
  lastSyncAt              DateTime  @default(now())
  syncStatus              String    @default("healthy")
  accessToken             String?
  refreshToken            String?
  expiresAt               DateTime?
  autoSync                Boolean   @default(true)
  syncFrequency           Int       @default(15)
  enableDeliveryTracking  Boolean   @default(true)
  enableSentimentAnalysis Boolean   @default(true)
  autoFollowUp            Boolean   @default(false)
  createdAt               DateTime  @default(now())
  updatedAt               DateTime
}

model email_messages {
  id                String   @id @default(ulid())
  messageId         String
  threadId          String?
  accountId         String
  subject           String
  body              String
  bodyHtml          String?
  from              String
  to                String[]
  cc                String[]
  bcc               String[]
  replyTo           String?
  sentAt            DateTime
  receivedAt        DateTime
  isRead            Boolean  @default(false)
  isImportant       Boolean  @default(false)
  labels            String[]
  attachments       Json?
  tracking          Json?
  createdAt         DateTime @default(now())
  updatedAt         DateTime
  buyingSignal      String?  @db.VarChar(100)
  buyingSignalScore Float?   @default(0.0)
}

model email_sequences {
  id          String   @id @default(ulid())
  workspaceId String
  userId      String
  name        String
  description String?
  isActive    Boolean  @default(true)
  steps       Json
  triggers    Json
  settings    Json
  stats       Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model entity_version_history {
  id           String   @id @default(ulid())
  workspaceId  String   @db.VarChar(30)
  entityType   String   @db.VarChar(50)
  entityId     String   @db.VarChar(30)
  version      Int
  changeType   String   @db.VarChar(20)
  fieldChanges Json
  changedBy    String   @db.VarChar(30)
  changeReason String?
  rollbackData Json?
  timestamp    DateTime @default(now())
}

model events {
  id             String    @id @default(ulid())
  workspaceId    String    @db.VarChar(30)
  userId         String    @db.VarChar(30)
  calendarId     String    @db.VarChar(30)
  title          String
  description    String?
  location       String?
  startTime      DateTime
  endTime        DateTime
  isAllDay       Boolean   @default(false)
  isRecurring    Boolean   @default(false)
  recurrenceRule String?
  status         String    @default("confirmed") @db.VarChar(20)
  visibility     String    @default("default") @db.VarChar(20)
  platform       String    @default("microsoft") @db.VarChar(20)
  externalId     String?
  meetingUrl     String?
  attendees      Json?
  organizer      Json?
  reminders      Json?
  attachments    Json?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  syncedAt       DateTime?

  @@index([calendarId])
  @@index([endTime])
  @@index([externalId])
  @@index([platform])
  @@index([startTime])
  @@index([status])
  @@index([userId])
  @@index([workspaceId])
}

model executive_contact {
  id                  String    @id @default(ulid())
  account_id          String?
  name                String
  title               String?
  role                String
  email               String?
  phone               String?
  linkedin_url        String?
  confidence_score    Int       @default(0)
  research_methods    String[]
  selection_reasoning String?
  last_verified       DateTime?
  is_current          Boolean   @default(true)
  workspace_id        String
  created_at          DateTime  @default(now())
  updated_at          DateTime
}

model interviews {
  id             String   @id @default(ulid())
  candidateId    String
  jobId          String
  type           String   @db.VarChar(50)
  scheduledDate  DateTime
  interviewer    String   @db.VarChar(255)
  feedback       String?
  rating         Int?
  recommendation String?  @db.VarChar(50)
  status         String   @default("scheduled") @db.VarChar(50)
  duration       Int?
  notes          String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime
}

model job_applications {
  id              String   @id @default(ulid())
  candidateId     String
  jobId           String
  applicationDate DateTime @default(now())
  status          String   @default("applied") @db.VarChar(50)
  source          String?  @db.VarChar(100)
  coverLetter     String?
  resumeUrl       String?  @db.VarChar(500)
  notes           String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime
}

model jobs {
  id                String    @id @default(ulid())
  title             String    @db.VarChar(255)
  department        String    @db.VarChar(100)
  level             String    @db.VarChar(50)
  type              String    @default("full-time") @db.VarChar(50)
  location          Json?
  salaryMin         Decimal?  @db.Decimal(10, 2)
  salaryMax         Decimal?  @db.Decimal(10, 2)
  currency          String    @default("USD") @db.VarChar(3)
  benefits          String[]  @default([])
  requirements      Json?
  description       String?
  status            String    @default("open") @db.VarChar(50)
  urgency           String    @default("medium") @db.VarChar(20)
  clientCompanyId   String?   @db.VarChar(30)
  clientCompanyName String?   @db.VarChar(255)
  recruiterAssigned String    @db.VarChar(30)
  hiringManager     String?   @db.VarChar(255)
  workspaceId       String    @db.VarChar(30)
  deadline          DateTime?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime
}

model leads {
  id                  String    @id @default(ulid())
  workspaceId         String    @db.VarChar(30)
  assignedUserId      String?   @db.VarChar(30)
  firstName           String
  lastName            String
  fullName            String
  displayName         String?
  email               String?
  workEmail           String?
  personalEmail       String?
  phone               String?
  mobilePhone         String?
  workPhone           String?
  company             String?
  companyDomain       String?
  industry            String?
  companySize         String?
  jobTitle            String?
  title               String?
  department          String?
  linkedinUrl         String?
  address             String?
  city                String?
  state               String?
  country             String?
  postalCode          String?   @db.VarChar(20)
  status              String    @default("new") @db.VarChar(50)
  priority            String    @default("medium") @db.VarChar(30)
  source              String?
  estimatedValue      Float?
  currency            String    @default("USD") @db.VarChar(3)
  notes               String?
  description         String?
  tags                String[]  @default([])
  customFields        Json?
  preferredLanguage   String?   @db.VarChar(10)
  timezone            String?   @db.VarChar(50)
  lastEnriched        DateTime?
  enrichmentSources   String[]  @default([])
  emailVerified       Boolean   @default(false)
  phoneVerified       Boolean   @default(false)
  mobileVerified      Boolean   @default(false)
  enrichmentScore     Float?
  emailConfidence     Float?
  phoneConfidence     Float?
  dataCompleteness    Float?
  createdAt           DateTime  @default(now())
  updatedAt           DateTime
  personId            String?
  deletedAt           DateTime?
  buyerGroupRole      String?   @db.VarChar(50)
  completedStages     String[]  @default([])
  currentStage        String?   @db.VarChar(50)
  lastActionDate      DateTime?
  nextAction          String?
  nextActionDate      DateTime?
  relationship        String?   @db.VarChar(30)
  demoScenarioId      String?
  isDemoData          Boolean   @default(false)
  externalId          String?
  vertical            String?   @db.VarChar(50)
  zohoId              String?   @db.VarChar(50)
  authority           String?   @db.VarChar(30)
  avgResponseTime     Float?    @default(0)
  budget              Float?
  buyingSignals       String[]  @default([])
  communicationStyle  String?   @default("Professional") @db.VarChar(30)
  competitorMentions  String[]  @default([])
  dateOfBirth         DateTime?
  decisionMakingStyle String?   @default("Analytical") @db.VarChar(30)
  engagementLevel     String?   @default("low") @db.VarChar(20)
  hobbies             String[]  @default([])
  interests           String[]  @default([])
  lastContactDate     DateTime?
  marketingQualified  Boolean   @default(false)
  needUrgency         String?   @db.VarChar(30)
  nextFollowUpDate    DateTime?
  painPoints          String[]  @default([])
  personalGoals       String[]  @default([])
  professionalGoals   String[]  @default([])
  responseRate        Float?    @default(0)
  salesQualified      Boolean   @default(false)
  timeline            String?   @db.VarChar(30)
  touchPointsCount    Int       @default(0)
  workAnniversary     DateTime?
  companyId           String?
  createdBy           String?   @db.VarChar(30)
  updatedBy           String?   @db.VarChar(30)
  version             Int       @default(1)
  entity_id           String?   @db.VarChar(30)
  lastAction          String?
  rank                Int?      @default(0)

  @@index([createdBy], map: "idx_leads_created_by")
  @@index([updatedBy], map: "idx_leads_updated_by")
  @@index([workspaceId, assignedUserId], map: "idx_leads_workspace_assigned")
  @@index([workspaceId, status], map: "idx_leads_workspace_status")
  @@index([entity_id], map: "idx_leads_entity_id")
  @@index([rank], map: "idx_leads_rank")
  @@index([workspaceId, rank], map: "idx_leads_workspace_rank")
}

model notes {
  id            String   @id @default(ulid())
  workspaceId   String   @db.VarChar(30)
  authorId      String   @db.VarChar(30)
  leadId        String?  @db.VarChar(30)
  opportunityId String?  @db.VarChar(30)
  accountId     String?  @db.VarChar(30)
  contactId     String?  @db.VarChar(30)
  title         String?
  content       String
  summary       String?
  type          String   @default("general") @db.VarChar(20)
  priority      String   @default("normal") @db.VarChar(10)
  isPrivate     Boolean  @default(false)
  isPinned      Boolean  @default(false)
  format        String   @default("text") @db.VarChar(20)
  attachments   Json?
  tags          String[] @default([])
  createdAt     DateTime @default(now())
  updatedAt     DateTime
  externalId    String?
  prospectId    String?  @db.VarChar(30)
  companyId     String?  @db.VarChar(30)
  personId      String?  @db.VarChar(30)
}

model opportunities {
  id                        String    @id @default(ulid())
  workspaceId               String    @db.VarChar(30)
  leadId                    String?   @db.VarChar(30)
  accountId                 String?   @db.VarChar(30)
  assignedUserId            String?   @db.VarChar(30)
  name                      String
  description               String?
  amount                    Float?
  currency                  String    @default("USD") @db.VarChar(3)
  probability               Float?    @default(0.5)
  stage                     String    @default("Build Rapport") @db.VarChar(100)
  priority                  String    @default("medium") @db.VarChar(30)
  source                    String?
  expectedCloseDate         DateTime?
  actualCloseDate           DateTime?
  notes                     String?
  nextSteps                 String?
  tags                      String[]  @default([])
  customFields              Json?
  riskScore                 Float?
  createdAt                 DateTime  @default(now())
  updatedAt                 DateTime
  deletedAt                 DateTime?
  buyingCommittee           Json?
  competitionData           Json?
  dealAnalysis              String?
  lastActivityDate          DateTime?
  nextActivityDate          DateTime?
  stageEntryDate            DateTime?
  demoScenarioId            String?
  isDemoData                Boolean   @default(false)
  externalId                String?
  zohoId                    String?   @db.VarChar(50)
  accelerationOpportunities String[]  @default([])
  champion                  String?
  championCoalition         Json?
  closePredictionConfidence Float?
  closePredictionReasoning  String?
  competitiveThreats        Json?
  decisionCriteria          Json?
  decisionProcess           Json?
  economicBuyer             String?
  economicImpact            Json?
  implementation            Json?
  intelligence              Json?
  lastPrecisionUpdate       DateTime?
  nextActions               Json?
  outcomePredict            Json?
  painPriority              Json?
  politicalMap              Json?
  precisionData             Json?
  precisionScore            Json?
  predictedCloseDate        DateTime?
  realityCheck              Json?
  riskFactors               String[]  @default([])
  solutionFit               Json?
  todayVsReality            Json?
  urgencyFactors            String[]  @default([])
  companyId                 String?
  personId                  String?
  createdBy                 String?   @db.VarChar(30)
  updatedBy                 String?   @db.VarChar(30)
  version                   Int       @default(1)
  entity_id                 String?   @db.VarChar(30)

  @@index([createdBy], map: "idx_opportunities_created_by")
  @@index([updatedBy], map: "idx_opportunities_updated_by")
  @@index([workspaceId, assignedUserId], map: "idx_opportunities_workspace_assigned")
  @@index([workspaceId, stage], map: "idx_opportunities_workspace_stage")
  @@index([entity_id], map: "idx_opportunities_entity_id")
}

model partners {
  id                   String    @id @default(ulid())
  workspaceId          String    @db.VarChar(30)
  assignedUserId       String?   @db.VarChar(30)
  name                 String
  company              String?
  email                String?
  phone                String?
  website              String?
  linkedinUrl          String?
  industry             String?
  size                 String?
  country              String?
  city                 String?
  state                String?
  address              String?
  partnershipType      String    @default("Strategic") @db.VarChar(50)
  partnershipModel     String    @default("Channel Partner") @db.VarChar(50)
  partnershipStartDate DateTime?
  partnershipValue     String    @default("High") @db.VarChar(20)
  revenueShare         String    @default("20%") @db.VarChar(10)
  territory            String    @default("Regional") @db.VarChar(50)
  exclusivity          String    @default("Non-exclusive") @db.VarChar(20)
  performanceScore     Float     @default(85)
  partnerRevenue       Float     @default(0)
  revenueGrowth        Float     @default(0)
  dealsClosed          Int       @default(0)
  pipelineValue        Float     @default(0)
  winRate              Float     @default(0)
  avgDealSize          Float     @default(0)
  certificationLevel   String    @default("Silver Partner") @db.VarChar(30)
  salesCertified       Boolean   @default(false)
  techCertified        Boolean   @default(false)
  lastTrainingDate     DateTime?
  nextTrainingDate     DateTime?
  mdfAllocation        String    @default("$25K") @db.VarChar(20)
  coreCompetencies     String[]  @default([])
  serviceOfferings     String[]  @default([])
  keyStrengths         String[]  @default([])
  growthOpportunities  String[]  @default([])
  notes                String?
  tags                 String[]  @default([])
  customFields         Json?
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  deletedAt            DateTime?

  @@index([assignedUserId])
  @@index([partnershipType])
  @@index([workspaceId])
}

model prospects {
  id                  String    @id @default(ulid())
  workspaceId         String    @db.VarChar(30)
  assignedUserId      String?   @db.VarChar(30)
  zohoId              String?   @db.VarChar(50)
  firstName           String
  lastName            String
  fullName            String
  displayName         String?
  email               String?
  workEmail           String?
  personalEmail       String?
  phone               String?
  mobilePhone         String?
  workPhone           String?
  company             String?
  companyDomain       String?
  industry            String?
  vertical            String?   @db.VarChar(50)
  companySize         String?
  jobTitle            String?
  title               String?
  department          String?
  linkedinUrl         String?
  address             String?
  city                String?
  state               String?
  country             String?
  postalCode          String?   @db.VarChar(20)
  status              String    @default("engaged") @db.VarChar(50)
  priority            String    @default("medium") @db.VarChar(30)
  source              String?
  estimatedValue      Float?
  currency            String    @default("USD") @db.VarChar(3)
  notes               String?
  description         String?
  tags                String[]  @default([])
  customFields        Json?
  preferredLanguage   String?   @db.VarChar(10)
  timezone            String?   @db.VarChar(50)
  lastEnriched        DateTime?
  enrichmentSources   String[]  @default([])
  emailVerified       Boolean   @default(false)
  phoneVerified       Boolean   @default(false)
  mobileVerified      Boolean   @default(false)
  enrichmentScore     Float?
  emailConfidence     Float?
  phoneConfidence     Float?
  dataCompleteness    Float?
  engagementLevel     String    @default("initial") @db.VarChar(30)
  lastContactDate     DateTime?
  nextFollowUpDate    DateTime?
  touchPointsCount    Int       @default(0)
  responseRate        Float?
  avgResponseTime     Float?
  buyingSignals       String[]  @default([])
  painPoints          String[]  @default([])
  interests           String[]  @default([])
  budget              Float?
  authority           String?   @db.VarChar(30)
  needUrgency         String?   @db.VarChar(30)
  timeline            String?   @db.VarChar(30)
  competitorMentions  String[]  @default([])
  marketingQualified  Boolean   @default(false)
  salesQualified      Boolean   @default(false)
  createdAt           DateTime  @default(now())
  updatedAt           DateTime
  personId            String?
  deletedAt           DateTime?
  buyerGroupRole      String?   @db.VarChar(50)
  completedStages     String[]  @default([])
  currentStage        String?   @db.VarChar(50)
  lastActionDate      DateTime?
  nextAction          String?
  nextActionDate      DateTime?
  relationship        String?   @db.VarChar(30)
  demoScenarioId      String?
  isDemoData          Boolean   @default(false)
  externalId          String?
  communicationStyle  String?   @default("Professional") @db.VarChar(30)
  dateOfBirth         DateTime?
  decisionMakingStyle String?   @default("Analytical") @db.VarChar(30)
  hobbies             String[]  @default([])
  personalGoals       String[]  @default([])
  professionalGoals   String[]  @default([])
  workAnniversary     DateTime?
  companyId           String?
  createdBy           String?   @db.VarChar(30)
  updatedBy           String?   @db.VarChar(30)
  version             Int       @default(1)
  entity_id           String?   @db.VarChar(30)
  rank                Int?      @default(0)

  @@index([createdBy], map: "idx_prospects_created_by")
  @@index([updatedBy], map: "idx_prospects_updated_by")
  @@index([workspaceId, assignedUserId], map: "idx_prospects_workspace_assigned")
  @@index([workspaceId, status], map: "idx_prospects_workspace_status")
  @@index([entity_id], map: "idx_prospects_entity_id")
  @@index([rank], map: "idx_prospects_rank")
  @@index([workspaceId, rank], map: "idx_prospects_workspace_rank")
}

model realtime_subscriptions {
  id               String   @id @default(ulid())
  workspaceId      String   @db.VarChar(30)
  userId           String   @db.VarChar(30)
  sessionId        String   @db.VarChar(100)
  subscriptionType String   @db.VarChar(50)
  entityFilters    Json
  isActive         Boolean  @default(true)
  lastPing         DateTime @default(now())
  createdAt        DateTime @default(now())
  expiresAt        DateTime
}

model research_error {
  id            String   @id @default(ulid())
  session_id    String
  account_id    String?
  error_code    String
  error_message String
  module        String
  is_retryable  Boolean  @default(true)
  created_at    DateTime @default(now())
}

model research_session {
  id                 String    @id @default(ulid())
  account_ids        String[]
  target_roles       String[]
  research_depth     String
  status             String    @default("pending")
  progress           Int       @default(0)
  total_cost         Decimal   @default(0) @db.Decimal(10, 4)
  executives_found   Int       @default(0)
  confidence_avg     Int       @default(0)
  processing_time_ms Int       @default(0)
  research_methods   String[]
  user_id            String
  workspace_id       String
  created_at         DateTime  @default(now())
  completed_at       DateTime?
}

model speedrun_daily_progress {
  id               String   @id @default(ulid())
  userId           String   @db.VarChar(30)
  workspaceId      String   @db.VarChar(30)
  date             DateTime @db.Date
  targetCount      Int      @default(100)
  completedCount   Int      @default(0)
  viewedCount      Int      @default(0)
  skippedCount     Int      @default(0)
  completedLeadIds String[] @default([])
  viewedLeadIds    String[] @default([])
  skippedLeadIds   String[] @default([])
  isComplete       Boolean  @default(false)
  lastActivity     DateTime @default(now())
}

model standard_table_attributes {
  id              String   @id @default(ulid())
  workspaceId     String   @db.VarChar(30)
  tableName       String   @db.VarChar(100)
  name            String   @db.VarChar(100)
  displayName     String   @db.VarChar(200)
  description     String?
  type            String   @db.VarChar(50)
  isRequired      Boolean  @default(false)
  isUnique        Boolean  @default(false)
  isSearchable    Boolean  @default(true)
  defaultValue    String?
  validationRules Json?
  options         Json?
  sortOrder       Int      @default(0)
  isVisible       Boolean  @default(true)
  width           Int?     @default(200)
  helpText        String?
  isComputed      Boolean  @default(false)
  formula         String?
  isEncrypted     Boolean  @default(false)
  createdAt       DateTime @default(now())
  updatedAt       DateTime
  createdBy       String   @db.VarChar(30)
  updatedBy       String?  @db.VarChar(30)
  version         Int      @default(1)

  @@unique([workspaceId, tableName, name])
  @@index([type])
  @@index([workspaceId, tableName])
  @@index([workspaceId, tableName, isVisible])
}

model standard_table_data {
  id           String   @id @default(ulid())
  workspaceId  String   @db.VarChar(30)
  tableName    String   @db.VarChar(100)
  recordId     String   @db.VarChar(30)
  extendedData Json
  searchVector String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime
  createdBy    String   @db.VarChar(30)
  updatedBy    String?  @db.VarChar(30)
  version      Int      @default(1)

  @@unique([workspaceId, tableName, recordId])
  @@index([searchVector], map: "idx_standard_table_data_search")
  @@index([workspaceId, tableName])
  @@index([workspaceId, tableName, recordId])
}

model strategic_insights {
  id                 String   @id @default(ulid())
  workspaceId        String
  insightType        String
  title              String
  description        String
  businessStage      String
  kpiCategory        String
  impactPotential    Float
  confidence         Float
  actionable         Boolean
  supportingData     Json
  recommendedActions Json
  status             String
  createdAt          DateTime @default(now())
  updatedAt          DateTime
}

model strategic_weights {
  id             String   @id @default(ulid())
  workspaceId    String
  actionType     String
  contextFactors Json
  businessStage  String
  kpiCategory    String
  weight         Float
  confidence     Float
  sampleSize     Int
  lastUpdated    DateTime @default(now())
  createdAt      DateTime @default(now())
}

model user_ai_preferences {
  id                   String    @id @default(ulid())
  userId               String    @db.VarChar(30)
  workspaceId          String    @db.VarChar(30)
  personalityId        String    @default("balanced") @db.VarChar(50)
  personalityName      String    @default("Balanced Professional") @db.VarChar(100)
  customPrompt         String?
  tone                 String    @default("helpful and professional") @db.VarChar(100)
  style                String    @default("balanced") @db.VarChar(50)
  isActive             Boolean   @default(true)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime
  communicationSamples Json?
  lastStyleUpdate      DateTime?
  persistentMemory     String?
  useEmojis            Boolean   @default(false)
  writingStyleAnalysis String?
  writingStylePrompt   String?
}

model users {
  id                      String        @id @default(ulid())
  email                   String
  password                String?
  name                    String
  firstName               String?
  lastName                String?
  displayName             String?
  preferredLanguage       String        @default("en") @db.VarChar(10)
  countryCode             String?       @db.VarChar(2)
  timezone                String?       @db.VarChar(50)
  locale                  String?       @db.VarChar(10)
  textDirection           String        @default("ltr") @db.VarChar(3)
  address                 String?
  city                    String?
  state                   String?
  country                 String?
  postalCode              String?       @db.VarChar(20)
  bio                     String?
  notes                   String?
  createdAt               DateTime      @default(now())
  updatedAt               DateTime
  lastLoginAt             DateTime?
  externalId              String?
  isSSO                   Boolean       @default(false)
  isActive                Boolean       @default(true)
  scimSource              String?
  lastSyncAt              DateTime?
  ssoProviderId           String?
  resetToken              String?
  resetTokenExpiry        DateTime?
  communicationStyle      String?       @default("consultative") @db.VarChar(30)
  coreSignalCreditsLimit  Int?          @default(500)
  coreSignalCreditsUsed   Int?          @default(0)
  coreSignalLastReset     DateTime?     @default(now())
  dashboardConfig         Json?         @default("{\"kpis\": [], \"widgets\": [], \"defaultView\": \"speedrun\"}")
  department              String?       @db.VarChar(50)
  intelligenceFocus       Json?         @default("{\"buyingSignals\": true, \"competitorMentions\": false, \"stakeholderMapping\": true}")
  linkedinUrl             String?       @db.VarChar(255)
  manager                 String?       @db.VarChar(30)
  notificationPreferences Json?         @default("{\"urgency\": \"medium\", \"channels\": [\"in_app\"], \"frequency\": \"hourly\"}")
  phoneNumber             String?       @db.VarChar(20)
  preferredDetailLevel    String?       @default("detailed") @db.VarChar(20)
  profilePictureUrl       String?       @db.VarChar(255)
  quota                   Decimal?      @db.Decimal(15, 2)
  seniorityLevel          String?       @db.VarChar(20)
  startDate               DateTime?
  territory               String?       @db.VarChar(100)
  title                   String?       @db.VarChar(100)
  activeWorkspaceId       String?       @db.VarChar(30)
  createdBy               String?       @db.VarChar(30)
  updatedBy               String?       @db.VarChar(30)
  version                 Int           @default(1)
  username                String?       @unique @db.VarChar(50)
  resetTokens             resetTokens[]
  workspaces              workspaces?   @relation(fields: [activeWorkspaceId], references: [id])

  @@index([activeWorkspaceId], map: "idx_users_active_workspace")
  @@index([createdBy], map: "idx_users_created_by")
  @@index([updatedBy], map: "idx_users_updated_by")
  @@index([username], map: "idx_users_username")
}

model resetTokens {
  id        String   @id @default(ulid())
  token     String   @unique
  userId    String
  expiresAt DateTime
  used      Boolean  @default(false)
  createdAt DateTime @default(now())
  user      users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([token])
  @@index([userId])
  @@index([expiresAt])
  @@index([used])
}

model webhook_subscriptions {
  id             String    @id @default(ulid())
  accountId      String
  platform       String
  subscriptionId String
  isActive       Boolean   @default(true)
  expiresAt      DateTime?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime
  companyId      String?   @db.VarChar(30)
}

model workspace_users {
  id          String   @id @default(ulid())
  workspaceId String   @db.VarChar(30)
  userId      String   @db.VarChar(30)
  role        String   @default("member") @db.VarChar(20)
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model workspaces {
  id                   String   @id @default(ulid())
  name                 String
  slug                 String
  defaultLanguage      String   @default("en") @db.VarChar(10)
  supportedLanguages   String[] @default(["en"])
  timezone             String   @default("UTC") @db.VarChar(50)
  description          String?
  currency             String   @default("USD") @db.VarChar(3)
  dateFormat           String   @default("MM/dd/yyyy") @db.VarChar(20)
  numberFormat         String   @default("1,234.56") @db.VarChar(20)
  createdAt            DateTime @default(now())
  updatedAt            DateTime
  companyId            String?
  bundleId             String?
  auditRetentionDays   Int?     @default(90)
  primaryRegion        String?
  complianceFrameworks Json?
  subscriptionTier     String?
  subscriptionStatus   String?
  scimEnabled          Boolean  @default(false)
  ssoEnabled           Boolean  @default(false)
  allowedRegions       String[] @default([])
  logoUrl              String?  @db.VarChar(255)
  primaryColor         String?  @db.VarChar(7)
  secondaryColor       String?  @db.VarChar(7)
  createdBy            String?  @db.VarChar(30)
  updatedBy            String?  @db.VarChar(30)
  version              Int      @default(1)
  businessModel        String?  @db.VarChar(100)
  companyContext       Json?
  projectDeliveryStyle String?  @default("Strategic Clarity") @db.VarChar(50)
  serviceFocus         String[] @default([])
  stakeholderApproach  String?  @default("Client-Centric") @db.VarChar(50)
  users                users[]

  @@index([createdBy], map: "idx_workspaces_created_by")
  @@index([updatedBy], map: "idx_workspaces_updated_by")
}

model audit_logs {
  id              String    @id @db.VarChar(26)
  workspace_id    String    @db.VarChar(30)
  user_id         String    @db.VarChar(30)
  entity_type     String    @db.VarChar(50)
  entity_id       String    @db.VarChar(30)
  action          String    @db.VarChar(20)
  old_values      Json?
  new_values      Json?
  changed_fields  String[]  @default([])
  ip_address      String?   @db.Inet
  user_agent      String?
  session_id      String?   @db.VarChar(100)
  business_reason String?   @db.VarChar(500)
  timestamp       DateTime? @default(now()) @db.Timestamptz(6)
  duration        Int?
  success         Boolean?  @default(true)
  error_message   String?   @db.VarChar(1000)

  @@index([action, timestamp], map: "idx_audit_logs_action_timestamp")
  @@index([entity_type, entity_id, timestamp], map: "idx_audit_logs_entity_id_timestamp")
  @@index([user_id, timestamp], map: "idx_audit_logs_user_timestamp")
  @@index([workspace_id, action, timestamp], map: "idx_audit_logs_workspace_action_timestamp")
  @@index([workspace_id, entity_type, timestamp], map: "idx_audit_logs_workspace_entity_timestamp")
  @@index([workspace_id, timestamp], map: "idx_audit_logs_workspace_timestamp")
}

model audit_analytics {
  id                    String    @id @db.VarChar(26)
  workspace_id          String    @db.VarChar(30)
  date                  DateTime  @db.Date
  total_actions         Int?      @default(0)
  create_count          Int?      @default(0)
  update_count          Int?      @default(0)
  delete_count          Int?      @default(0)
  read_count            Int?      @default(0)
  leads_actions         Int?      @default(0)
  prospects_actions     Int?      @default(0)
  opportunities_actions Int?      @default(0)
  companies_actions     Int?      @default(0)
  people_actions        Int?      @default(0)
  unique_users          Int?      @default(0)
  avg_actions_per_user  Float?
  avg_response_time     Float?
  error_count           Int?      @default(0)
  created_at            DateTime? @default(now()) @db.Timestamptz(6)

  @@unique([workspace_id, date])
  @@index([date], map: "idx_audit_analytics_date")
  @@index([workspace_id, date], map: "idx_audit_analytics_workspace_date")
}

model opportunity_stage_templates {
  id           String    @id @db.VarChar(26)
  workspace_id String    @db.VarChar(26)
  name         String    @db.VarChar(100)
  description  String?
  stages       Json
  is_default   Boolean?  @default(false)
  is_active    Boolean?  @default(true)
  created_at   DateTime? @default(now()) @db.Timestamp(6)
  updated_at   DateTime? @default(now()) @db.Timestamp(6)
  created_by   String?   @db.VarChar(26)
  updated_by   String?   @db.VarChar(26)

  @@index([is_default, is_active], map: "idx_opportunity_stage_templates_default")
  @@index([workspace_id], map: "idx_opportunity_stage_templates_workspace")
}

model workspace_opportunity_stages {
  id            String    @id @db.VarChar(26)
  workspace_id  String    @db.VarChar(26)
  template_id   String?   @db.VarChar(26)
  custom_stages Json?
  is_active     Boolean?  @default(true)
  created_at    DateTime? @default(now()) @db.Timestamp(6)
  updated_at    DateTime? @default(now()) @db.Timestamp(6)

  @@index([workspace_id], map: "idx_workspace_opportunity_stages_workspace")
}

model client_accounts {
  id                String    @id
  name              String    @db.VarChar(255)
  agencyWorkspaceId String
  workspaceId       String    @db.VarChar(30)
  permissions       Json?
  isActive          Boolean   @default(true)
  contractStart     DateTime?
  contractEnd       DateTime?
  monthlyFee        Decimal?  @db.Decimal(10, 2)
  commissionRate    Decimal?  @db.Decimal(5, 2)
  settings          Json?
  branding          Json?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime
}

model client_users {
  id              String   @id
  userId          String   @db.VarChar(30)
  clientAccountId String
  role            String   @default("hiring_manager") @db.VarChar(50)
  permissions     Json?
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime
}

model clients {
  id                       String    @id
  workspaceId              String    @db.VarChar(30)
  customerSince            DateTime
  customerStatus           String    @default("active") @db.VarChar(20)
  tier                     String?   @db.VarChar(20)
  segment                  String?   @db.VarChar(50)
  totalLifetimeValue       Float     @default(0)
  avgDealSize              Float     @default(0)
  dealCount                Int       @default(0)
  lastDealValue            Float     @default(0)
  annualRecurringRevenue   Float     @default(0)
  projectedAnnualValue     Float     @default(0)
  contactCount             Int       @default(0)
  activityCount            Int       @default(0)
  emailCount               Int       @default(0)
  meetingCount             Int       @default(0)
  callCount                Int       @default(0)
  lastEngagementDate       DateTime?
  lastDealDate             DateTime?
  healthScore              Float     @default(75)
  expansionProbability     Float     @default(50)
  churnRisk                Float     @default(25)
  loyaltyScore             Float     @default(60)
  engagementScore          Float     @default(50)
  avgDealCycle             Int       @default(0)
  preferredProducts        String[]  @default([])
  seasonalPatterns         Json?
  communicationPreferences Json?
  buyingPatterns           Json?
  growthTrend              String?   @db.VarChar(20)
  retentionProbability     Float     @default(80)
  upsellPotential          Float     @default(50)
  crossSellOpportunities   String[]  @default([])
  nextBestAction           String?
  nextBestActionScore      Float     @default(0)
  nextBestActionDate       DateTime?
  renewalDate              DateTime?
  expansionOpportunity     String?
  onboardingDate           DateTime?
  firstPurchaseDate        DateTime?
  lastPurchaseDate         DateTime?
  nextExpectedPurchase     DateTime?
  contractEndDate          DateTime?
  customerType             String?   @db.VarChar(30)
  riskLevel                String    @default("low") @db.VarChar(20)
  priority                 String    @default("medium") @db.VarChar(20)
  tags                     String[]  @default([])
  satisfactionScore        Float?
  npsScore                 Int?
  supportTicketCount       Int       @default(0)
  escalationCount          Int       @default(0)
  lastCalculatedAt         DateTime  @default(now())
  calculationVersion       String    @default("1.0") @db.VarChar(10)
  relationshipStrength     String?   @default("Good") @db.VarChar(20)
  referralsProvided        Int       @default(0)
  caseStudyParticipation   Boolean   @default(false)
  trustLevel               String?   @default("High") @db.VarChar(20)
  advocacyLevel            String?   @default("Promoter") @db.VarChar(20)
  clientAnniversary        DateTime?
  accountManager           String?
  successManager           String?
  executiveSponsor         String?
  meetingFrequency         String?   @default("Monthly") @db.VarChar(20)
  roiAchieved              Float?    @default(240)
  timeToValue              Int?      @default(45)
  dailyActiveUsers         Int       @default(0)
  featureAdoption          Float?    @default(0.78)
  costSavings              Float?    @default(0)
  efficiencyGain           Float?    @default(0.35)
  revenueImpact            Float?    @default(0)
  timeSaved                String?   @default("20 hrs/week") @db.VarChar(20)
  ninetyDayGoals           String[]  @default([])
  annualObjectives         String[]  @default([])
  successRisks             String[]  @default([])
  renewalProbability       Float?    @default(0.95)
  contractValue            Float?    @default(0)
  createdAt                DateTime  @default(now())
  updatedAt                DateTime
  deletedAt                DateTime?
  companyId                String?
  personId                 String?
  assignedUserId           String?   @db.VarChar(30)
  entity_id                String?   @db.VarChar(30)

  @@index([entity_id], map: "idx_clients_entity_id")
  @@index([assignedUserId])
  @@index([workspaceId])
}

model company {
  id            String   @id
  name          String
  website       String?
  industry      String?
  size          String?
  description   String?
  headquarters  String?
  foundedYear   Int?
  revenue       String?
  employeeCount String?
  isPublic      Boolean?
  stockSymbol   String?
  logoUrl       String?
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime

  @@index([industry])
  @@index([isActive])
  @@index([name])
}

model person {
  id                String   @id
  firstName         String?
  lastName          String?
  fullName          String
  email             String?  @unique
  phone             String?
  linkedinUrl       String?
  title             String?
  department        String?
  location          String?
  bio               String?
  profilePictureUrl String?
  isActive          Boolean  @default(true)
  createdAt         DateTime @default(now())
  updatedAt         DateTime

  @@index([email])
  @@index([fullName])
  @@index([isActive])
}

model industries {
  id                   String                  @id @default(ulid())
  workspaceId          String                  @db.VarChar(30)
  name                 String                  @unique @db.VarChar(100)
  code                 String                  @unique @db.VarChar(10)
  description          String?                 @db.VarChar(500)
  marketSize           String?                 @db.VarChar(100)
  growthRate           Float?
  maturity             String?                 @db.VarChar(20)
  keyTrends            String[]                @default([])
  commonPainPoints     String[]                @default([])
  buyingPatterns       Json?
  isActive             Boolean                 @default(true)
  sortOrder            Int                     @default(0)
  createdAt            DateTime                @default(now())
  updatedAt            DateTime                @default(now())
  companies            companies[]
  industryIntelligence industry_intelligence[]
  verticals            industry_verticals[]

  @@index([code])
  @@index([workspaceId])
}

model industry_verticals {
  id                   String                           @id @default(ulid())
  workspaceId          String                           @db.VarChar(30)
  industryId           String                           @db.VarChar(30)
  name                 String                           @db.VarChar(100)
  code                 String                           @db.VarChar(20)
  description          String?                          @db.VarChar(500)
  marketSize           String?                          @db.VarChar(100)
  growthRate           Float?
  maturity             String?                          @db.VarChar(20)
  keyPlayers           String[]                         @default([])
  marketLeaders        String[]                         @default([])
  emergingPlayers      String[]                         @default([])
  keyTrends            String[]                         @default([])
  painPoints           String[]                         @default([])
  opportunities        String[]                         @default([])
  avgSalesCycle        String?                          @db.VarChar(50)
  decisionMakers       String[]                         @default([])
  budgetSeason         String[]                         @default([])
  priceSensitivity     String?                          @db.VarChar(20)
  commonTechStack      String[]                         @default([])
  integrationNeeds     String[]                         @default([])
  complianceReqs       String[]                         @default([])
  regulatoryComplexity String?                          @db.VarChar(20)
  isActive             Boolean                          @default(true)
  sortOrder            Int                              @default(0)
  createdAt            DateTime                         @default(now())
  updatedAt            DateTime                         @default(now())
  companies            companies[]
  verticalIntelligence industry_vertical_intelligence[]
  industry             industries                       @relation(fields: [industryId], references: [id])

  @@unique([industryId, code], name: "industryId_code")
  @@index([industryId])
  @@index([code])
  @@index([workspaceId])
}

model industry_intelligence {
  id                 String     @id @default(ulid())
  workspaceId        String     @db.VarChar(30)
  industryId         String     @db.VarChar(30)
  intelligenceType   String     @db.VarChar(50)
  title              String     @db.VarChar(255)
  content            String
  summary            String?    @db.VarChar(1000)
  source             String?    @db.VarChar(100)
  url                String?    @db.VarChar(500)
  publishedDate      DateTime?
  relevanceScore     Float?
  impactLevel        String?    @db.VarChar(20)
  tags               String[]   @default([])
  companies          String[]   @default([])
  salesOpportunity   Boolean    @default(false)
  threatLevel        String?    @db.VarChar(20)
  actionableInsights String[]   @default([])
  isActive           Boolean    @default(true)
  isVerified         Boolean    @default(false)
  createdAt          DateTime   @default(now())
  updatedAt          DateTime   @default(now())
  industry           industries @relation(fields: [industryId], references: [id])

  @@index([industryId, intelligenceType])
  @@index([relevanceScore])
  @@index([publishedDate])
  @@index([workspaceId])
}

model industry_vertical_intelligence {
  id                 String             @id @default(ulid())
  workspaceId        String             @db.VarChar(30)
  verticalId         String             @db.VarChar(30)
  intelligenceType   String             @db.VarChar(50)
  title              String             @db.VarChar(255)
  content            String
  summary            String?            @db.VarChar(1000)
  source             String?            @db.VarChar(100)
  url                String?            @db.VarChar(500)
  publishedDate      DateTime?
  relevanceScore     Float?
  impactLevel        String?            @db.VarChar(20)
  tags               String[]           @default([])
  companies          String[]           @default([])
  competitors        String[]           @default([])
  salesOpportunity   Boolean            @default(false)
  threatLevel        String?            @db.VarChar(20)
  actionableInsights String[]           @default([])
  isActive           Boolean            @default(true)
  isVerified         Boolean            @default(false)
  createdAt          DateTime           @default(now())
  updatedAt          DateTime           @default(now())
  vertical           industry_verticals @relation(fields: [verticalId], references: [id])

  @@index([verticalId, intelligenceType])
  @@index([relevanceScore])
  @@index([publishedDate])
  @@index([workspaceId])
}

model competitors {
  id                   String   @id @default(ulid())
  workspaceId          String   @db.VarChar(30)
  name                 String   @unique @db.VarChar(255)
  description          String?  @db.VarChar(1000)
  website              String?  @db.VarChar(500)
  services             String[] @default([])
  strengths            String[] @default([])
  weaknesses           String[] @default([])
  marketShare          String?  @db.VarChar(20)
  founded              Int?
  employees            String?  @db.VarChar(50)
  funding              String?  @db.VarChar(100)
  headquarters         String?  @db.VarChar(255)
  revenue              String?  @db.VarChar(100)
  keyProducts          String[] @default([])
  targetMarkets        String[] @default([])
  pricingModel         String?  @db.VarChar(100)
  competitiveAdvantage String?  @db.VarChar(500)
  threatLevel          String?  @default("medium") @db.VarChar(20)
  isActive             Boolean  @default(true)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @default(now())

  @@index([workspaceId])
  @@index([threatLevel])
  @@index([isActive])
}

model marketIntelligence {
  id          String   @id @default(ulid())
  workspaceId String   @db.VarChar(30)
  title       String   @db.VarChar(255)
  description String?  @db.VarChar(1000)
  insights    String[] @default([])
  source      String?  @db.VarChar(100)
  relevance   String?  @default("medium") @db.VarChar(20)
  tags        String[] @default([])
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now())

  @@index([workspaceId])
  @@index([relevance])
  @@index([isActive])
}

model sellers {
  id             String    @id @default(ulid())
  workspaceId    String    @db.VarChar(30)
  name           String    @db.VarChar(255)
  firstName      String?   @db.VarChar(100)
  lastName       String?   @db.VarChar(100)
  email          String?   @db.VarChar(255)
  phone          String?   @db.VarChar(50)
  title          String?   @db.VarChar(255)
  department     String?   @db.VarChar(100)
  company        String?   @db.VarChar(255)
  assignedUserId String?   @db.VarChar(30)
  tags           String[]  @default([])
  metadata       Json?
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @default(now())
  deletedAt      DateTime?

  @@index([workspaceId])
  @@index([assignedUserId])
  @@index([deletedAt])
  @@index([workspaceId, deletedAt])
}
