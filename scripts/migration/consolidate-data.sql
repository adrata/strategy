-- Consolidate data from multiple tables into unified Person and Company tables
-- This script will merge data from contacts, leads, prospects into Person
-- and merge data from accounts, clients into Company

-- First, let's add missing columns to existing Person table
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "entityType" VARCHAR(20) DEFAULT 'contact';
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'active';
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "priority" VARCHAR(30) DEFAULT 'medium';
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "source" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "currentStage" VARCHAR(50);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "relationship" VARCHAR(50);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "buyerGroupRole" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "estimatedValue" FLOAT;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'USD';
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "lastContactDate" TIMESTAMP;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "nextFollowUpDate" TIMESTAMP;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "lastActionDate" TIMESTAMP;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "nextActionDate" TIMESTAMP;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "nextAction" VARCHAR(200);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "engagementLevel" VARCHAR(50);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "buyingSignals" TEXT[];
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "painPoints" TEXT[];
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "interests" TEXT[];
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "budget" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "authority" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "needUrgency" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "timeline" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "marketingQualified" BOOLEAN DEFAULT false;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "salesQualified" BOOLEAN DEFAULT false;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "accountId" VARCHAR(30);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "workEmail" VARCHAR(300);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "personalEmail" VARCHAR(300);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "secondaryEmail" VARCHAR(300);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "mobilePhone" VARCHAR(50);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "workPhone" VARCHAR(50);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "twitterHandle" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "personalWebsite" VARCHAR(500);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "address" VARCHAR(500);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "state" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "country" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "postalCode" VARCHAR(20);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "timezone" VARCHAR(50);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "bio" TEXT;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "customFields" JSONB;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "assignedUserId" VARCHAR(30);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "isVerified" BOOLEAN DEFAULT false;
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "externalId" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "zohoId" VARCHAR(100);
ALTER TABLE "Person" ADD COLUMN IF NOT EXISTS "deletedAt" TIMESTAMP;

-- Add missing columns to existing Company table
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "website" VARCHAR(500);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "industry" VARCHAR(100);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "size" VARCHAR(50);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "vertical" VARCHAR(100);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "email" VARCHAR(300);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "phone" VARCHAR(50);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "address" VARCHAR(500);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "city" VARCHAR(100);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "state" VARCHAR(100);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "country" VARCHAR(100);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "postalCode" VARCHAR(20);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "entityType" VARCHAR(20) DEFAULT 'account';
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "status" VARCHAR(50) DEFAULT 'active';
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "tier" VARCHAR(20);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "accountType" VARCHAR(50) DEFAULT 'Prospect';
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "revenue" FLOAT;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "contractValue" FLOAT;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "currency" VARCHAR(3) DEFAULT 'USD';
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "lastContactDate" TIMESTAMP;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "nextFollowUpDate" TIMESTAMP;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "engagementLevel" VARCHAR(50);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "buyingSignals" TEXT[];
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "painPoints" TEXT[];
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "interests" TEXT[];
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "description" TEXT;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "notes" TEXT;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "tags" TEXT[];
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "customFields" JSONB;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "assignedUserId" VARCHAR(30);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "isActive" BOOLEAN DEFAULT true;
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "externalId" VARCHAR(100);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "zohoId" VARCHAR(100);
ALTER TABLE "Company" ADD COLUMN IF NOT EXISTS "deletedAt" TIMESTAMP;
